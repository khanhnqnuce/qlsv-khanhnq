@using FDI
@using FDI.Utils
@model IEnumerable<FDI.Simple.ShopCommentItem>
@helper Truncate(string
input, int length)
{
    if (input.Length <= length)
    {
    @input
    }
    else
    {
    @input.Substring(0, length)<text>...</text>
    }
}
@{
    ViewBag.Title = "danh sách lịch sử bình luận";
    Layout = "~/Areas/Admin/Views/Shared/_Ajax.cshtml";
}

<script type="text/javascript">
    $(document).ready(function () {
        registerGridView('#gridItems');
    });


</script>

<section id="gridItems" class="vbox">
    <section class="scrollable wrapper w-f">
        <section class="panel panel-default">
            <table class="gridView" cellspacing="1">
                <tr>
                    <th><a href="#Field=ID">ID<span /></a></th>
                    <th><a href="#">Người bình luận<span /></a></th>
                    <th><a href="#Field=Title">Sản phẩm được bình luận<span /></a></th>
                    <th><a href="#Field=Content">Nội dung<span /></a></th>
                    <th>H.Thị</th>
                    <th><a href="#">Thời gian tạo<span /></a></th>
                    <th><a href="#">Thời gian hỏi/ trả lời<span /></a></th>
                    <th><a href="#">Trả lời sau<span /></a></th>
                    <th><a href="#Field=DatKPI">Đạt KPI<span /></a></th>

                    <th class="act_view"></th>


                </tr>
                @foreach (var item in Model)
                {

                    var thoiGianTraLoiComment = item.DateCreated != null && item.NgayTraLoi != null ? Convert.ToInt32((item.DateCreated.Value - item.NgayTraLoi.Value).TotalMinutes) : 0;

                    <tr title="@item.Title">
                        <td>@item.ID</td>
                        @if (!String.IsNullOrEmpty(item.Email))
                        {
                            <td>@item.Email</td>
                        }
                        else
                        {
                            <td>Khách</td>
                        }
                        <td>@item.Product.Name</td>
                        <td>@HttpUtility.HtmlDecode(FDI.Utils.MyString.Truncate(MyString.RemoveHTMLTag(item.Content), 50))</td>
                        <td>@Grid.DisplayShow(item.Title, !item.IsActive.HasValue || item.IsActive.Value)</td>
                        <td>@item.DateCreated</td>
                        <td>@item.NgayTraLoi</td>
                        @if (thoiGianTraLoiComment != 0)
                        {
                            <td>@Convert.ToString(item.ThoiGianTraLoiComment).Replace("-", "") phút</td>
                        }
                        else
                        {
                            <td>không rõ </td>
                        }
                        <td>@(item.DatKPI.HasValue && item.DatKPI.Value ? "Đạt" : "Không đạt")</td>

                        @*<td>@Grid.DisplayShowStrike(item.Email, item.IsActive)</td>*@
                        <td class="act_view">@Grid.ActionView(item.ID, item.Title)</td>

                    </tr>
                }
            </table>
        </section>
    </section>
    <footer class="footer bg-white b-t portlet">
        <div class="row m-t-xs">
            @Html.Raw(ViewBag.PageHtml)
        </div>
    </footer>
</section>



